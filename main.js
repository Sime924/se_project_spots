!function(){"use strict";function e(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";t?(console.log(`Setting text to ${n}`),e.textContent=n):e.textContent=r}const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},r=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},n=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},o=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},a=e=>{document.querySelectorAll(e.formSelector).forEach((t=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n(o,a,t),o.forEach((s=>{s.addEventListener("input",(function(){((e,t,n)=>{console.log(t.validationMessage),t.validity.valid?r(e,t,n):((e,t,r,n)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(n.inputErrorClass)})(e,t,t.validationMessage,n)})(e,s,t),n(o,a,t)}))}))})(t,e)}))};a(t);const s=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then(this._checkResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResponse)}editAvatarInfo(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(this._checkResponse)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9544c3a2-9ca1-48f5-a2e1-8da99a7924e4","Content-Type":"application/json"}});s.getAppInfo().then((e=>{let[t,r]=e;d.textContent=t.name,u.textContent=t.about,A.src=t.avatar,r.forEach((e=>{const t=j(e);C.append(t)}))})).catch(console.error);const c=document.querySelector(".profile__edit-btn"),l=document.querySelector(".profile__new-post-btn"),i=document.querySelector(".profile__avatar-btn"),d=document.querySelector(".profile__name"),u=document.querySelector(".profile__description"),m=document.querySelector("#edit-modal"),_=m.querySelector(".modal__form"),h=m.querySelector(".modal__close-btn"),v=m.querySelector("#profile-name-input"),S=m.querySelector("#profile-description-input"),y=document.querySelector("#add-card-modal"),f=y.querySelector(".modal__form"),p=y.querySelector(".modal__submit-btn"),b=y.querySelector(".modal__close-btn"),q=y.querySelector("#add-card-name-input"),k=y.querySelector("#add-card-link-input");let E,L;const g=document.querySelector("#card-template"),C=document.querySelector(".cards__list"),U=(document.querySelector(".card__image"),document.querySelector("#preview-modal")),x=U.querySelector(".modal__image"),$=U.querySelector(".modal__caption"),D=U.querySelector(".modal__close-btn_type_preview"),I=document.querySelector("#avatar-modal"),A=document.querySelector(".profile__avatar"),w=I.querySelector(".modal__form"),R=(I.querySelector(".modal__submit-btn"),I.querySelector(".modal__close-btn")),T=I.querySelector("#profile-avatar-input"),P=document.querySelector("#delete-modal"),B=P.querySelector(".modal__form"),N=P.querySelector(".modal__cancel-btn"),O=P.querySelector(".modal__close-btn");function j(e){const t=g.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return r.textContent=e.name,n.src=e.link,n.alt=e.name,e.isLiked&&o.classList.add("card__like-btn_liked"),o.addEventListener("click",(t=>function(e,t){const r=e.target,n=r.classList.contains("card__like-btn_liked");s.changeLikeStatus(t,n).then((()=>{r.classList.toggle("card__like-btn_liked")})).catch((e=>{console.error("Error updating like status",e)}))}(t,e._id))),n.addEventListener("click",(()=>{J(U),x.src=e.link,x.alt=e.name,$.textContent=e.name})),a.addEventListener("click",(r=>{!function(e,t){E=e,L=t,J(P)}(t,e._id)})),t}function J(e){e.classList.add("modal_opened"),document.addEventListener("keydown",M),e.addEventListener("mousedown",z)}function H(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",M),e.removeEventListener("mousedown",z)}function M(e){"Escape"===e.key&&H(document.querySelector(".modal_opened"))}function z(e){e.target.classList.contains("modal")&&H(e.target)}c.addEventListener("click",(()=>{var e,n;S.value=u.textContent,v.value=d.textContent,e=_,n=t,[v,S].forEach((t=>{r(e,t,n)})),J(m)})),h.addEventListener("click",(()=>{H(m),console.log("close button clicked")})),l.addEventListener("click",(()=>{J(y)})),b.addEventListener("click",(()=>{H(y)})),D.addEventListener("click",(()=>{H(U)})),i.addEventListener("click",(()=>{J(I)})),R.addEventListener("click",(()=>{H(I)})),O.addEventListener("click",(()=>{H(P)})),N.addEventListener("click",(()=>{H(P)})),w.addEventListener("submit",(function(t){t.preventDefault();const r=T.value,n=t.submitter;e(n,!0,"Save","Saving..."),s.editAvatarInfo({avatar:r}).then((e=>{A.src=e.avatar,H(I)})).catch(console.error).finally((()=>{e(n,!1)}))})),B.addEventListener("submit",(function(t){t.preventDefault();const r=t.submitter;e(r,!0,"Delete","Deleting..."),s.deleteCard(L).then((()=>{E&&(E.remove(),E=null,L=null),H(P)})).catch(console.error).finally((()=>{e(r,!1,"Delete","Deleting...")}))})),_.addEventListener("submit",(function(t){t.preventDefault();const r=t.submitter;e(r,!0,"Save","Saving..."),s.editUserInfo({name:v.value,about:S.value}).then((e=>{d.textContent=e.name,u.textContent=e.about,H(m)})).catch(console.error).finally((()=>{e(r,!1)}))})),f.addEventListener("submit",(function(r){r.preventDefault();const n={name:q.value.trim(),link:k.value.trim()},a=r.submitter;e(a,!0,"Save","Saving..."),s.addCard(n).then((e=>{const n=j(e);C.prepend(n),H(y),r.target.reset(),o(p,t)})).catch(console.error).finally((()=>{e(a,!1)}))})),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQU8sU0FBU0EsRUFDZEMsRUFDQUMsR0FHQSxJQUZBQyxFQUFXQyxVQUFBQyxPQUFBLFFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFHLE9BQ2RHLEVBQVdILFVBQUFDLE9BQUEsUUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQUcsWUFFVkYsR0FFRk0sUUFBUUMsSUFBSSxtQkFBbUJGLEtBQy9CTixFQUFJUyxZQUFjSCxHQUdsQk4sRUFBSVMsWUFBY1AsQ0FFdEIsQ0NkTyxNQUFNUSxFQUFXLENBQ3RCQyxhQUFjLGVBQ2RDLGNBQWUsZ0JBQ2ZDLHFCQUFzQixxQkFDdEJDLG9CQUFxQiw2QkFDckJDLGdCQUFpQiwwQkFDakJDLFdBQVksd0JBU1JDLEVBQWlCQSxDQUFDQyxFQUFRQyxFQUFTQyxLQUNwQkYsRUFBT0csY0FBYyxJQUFJRixFQUFRRyxZQUN6Q2IsWUFBYyxHQUN6QlUsRUFBUUksVUFBVUMsT0FBT0osRUFBT0wsZ0JBQWdCLEVBa0I1Q1UsRUFBb0JBLENBQUNDLEVBQVdDLEVBQVVQLEtBTnZCTSxJQUNoQkEsRUFBVUUsTUFBTUMsSUFDYkEsRUFBTUMsU0FBU0MsUUFLckJDLENBQWdCTixHQUNsQk8sRUFBY04sRUFBVVAsSUFFeEJPLEVBQVNPLFVBQVcsRUFDcEJQLEVBQVNKLFVBQVVDLE9BQU9KLEVBQU9OLHFCQUNuQyxFQUdXbUIsRUFBZ0JBLENBQUNOLEVBQVVQLEtBQ3RDTyxFQUFTTyxVQUFXLEVBQ3BCUCxFQUFTSixVQUFVWSxJQUFJZixFQUFPTixvQkFBb0IsRUF1QnZDc0IsRUFBb0JoQixJQUNkaUIsU0FBU0MsaUJBQWlCbEIsRUFBT1QsY0FDekM0QixTQUFTckIsSUFoQk1zQixFQUFDdEIsRUFBUUUsS0FDakMsTUFBTU0sRUFBWWUsTUFBTUMsS0FBS3hCLEVBQU9vQixpQkFBaUJsQixFQUFPUixnQkFDdEQrQixFQUFnQnpCLEVBQU9HLGNBQWNELEVBQU9QLHNCQUVsRFksRUFBa0JDLEVBQVdpQixFQUFldkIsR0FFNUNNLEVBQVVhLFNBQVNLLElBQ2pCQSxFQUFhQyxpQkFBaUIsU0FBUyxXQTFDaEJDLEVBQUM1QixFQUFRQyxFQUFTQyxLQUMzQ2IsUUFBUUMsSUFBSVcsRUFBUTRCLG1CQUNmNUIsRUFBUVcsU0FBU0MsTUFHcEJkLEVBQWVDLEVBQVFDLEVBQVNDLEdBakJiNEIsRUFBQzlCLEVBQVFDLEVBQVM4QixFQUFVN0IsS0FDOUJGLEVBQU9HLGNBQWMsSUFBSUYsRUFBUUcsWUFDekNiLFlBQWN3QyxFQUN6QjlCLEVBQVFJLFVBQVVZLElBQUlmLEVBQU9MLGdCQUFnQixFQVkzQ2lDLENBQWU5QixFQUFRQyxFQUFTQSxFQUFRNEIsa0JBQW1CM0IsRUFHN0QsRUFxQ0kwQixDQUFtQjVCLEVBQVEwQixFQUFjeEIsR0FDekNLLEVBQWtCQyxFQUFXaUIsRUFBZXZCLEVBQzlDLEdBQUUsR0FDRixFQU1Bb0IsQ0FBa0J0QixFQUFRRSxFQUFPLEdBQ2pDLEVBR0pnQixFQUFpQjFCLEdDcENqQixNQUFNd0MsRUFBTSxJQ3pDWixNQUNFQyxXQUFBQSxDQUFXQyxHQUF1QixJQUF0QixRQUFFQyxFQUFPLFFBQUVDLEdBQVNGLEVBQzlCRyxLQUFLQyxTQUFXSCxFQUNoQkUsS0FBS0UsU0FBV0gsQ0FFbEIsQ0FFQUksV0FBQUEsR0FDRSxPQUFPQyxNQUFNLEdBQUdKLEtBQUtDLG9CQUFxQixDQUN4Q0YsUUFBU0MsS0FBS0UsV0FDYkcsS0FBS0wsS0FBS00sZUFDZixDQUVBQyxVQUFBQSxHQUNFLE9BQU9DLFFBQVFDLElBQUksQ0FBQ1QsS0FBS0csY0FBZUgsS0FBS1UsbUJBQy9DLENBRUFBLGVBQUFBLEdBQ0UsT0FBT04sTUFBTSxHQUFHSixLQUFLQyxpQkFBa0IsQ0FDckNGLFFBQVNDLEtBQUtFLFdBQ2JHLEtBQUtMLEtBQUtNLGVBQ2YsQ0FFQUssT0FBQUEsQ0FBT0MsR0FBaUIsSUFBaEIsS0FBRUMsRUFBSSxLQUFFQyxHQUFNRixFQUNwQixPQUFPUixNQUFNLEdBQUdKLEtBQUtDLGlCQUFrQixDQUNyQ2MsT0FBUSxPQUNSaEIsUUFBU0MsS0FBS0UsU0FDZGMsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQkwsT0FDQUMsV0FFRFQsS0FBS0wsS0FBS00sZUFDZixDQUVBYSxZQUFBQSxDQUFZQyxHQUFrQixJQUFqQixLQUFFUCxFQUFJLE1BQUVRLEdBQU9ELEVBQzFCLE9BQU9oQixNQUFNLEdBQUdKLEtBQUtDLG9CQUFxQixDQUN4Q2MsT0FBUSxRQUNSaEIsUUFBU0MsS0FBS0UsU0FDZGMsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQkwsT0FDQVEsWUFFRGhCLEtBQUtMLEtBQUtNLGVBQ2YsQ0FFQWdCLGNBQUFBLENBQWNDLEdBQWEsSUFBWixPQUFFQyxHQUFRRCxFQUN2QixPQUFPbkIsTUFBTSxHQUFHSixLQUFLQywyQkFBNEIsQ0FDL0NjLE9BQVEsUUFDUmhCLFFBQVNDLEtBQUtFLFNBQ2RjLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJNLGFBRURuQixLQUFLTCxLQUFLTSxlQUNmLENBRUFtQixVQUFBQSxDQUFXMUQsR0FDVCxPQUFPcUMsTUFBTSxHQUFHSixLQUFLQyxrQkFBa0JsQyxJQUFNLENBQzNDZ0QsT0FBUSxTQUNSaEIsUUFBU0MsS0FBS0UsV0FDYkcsS0FBS0wsS0FBS00sZUFDZixDQUVBb0IsZ0JBQUFBLENBQWlCM0QsRUFBSTRELEdBQ25CLE9BQU92QixNQUFNLEdBQUdKLEtBQUtDLGtCQUFrQmxDLFVBQVksQ0FDakRnRCxPQUFRWSxFQUFVLFNBQVcsTUFDN0I1QixRQUFTQyxLQUFLRSxXQUNiRyxLQUFLTCxLQUFLTSxlQUNmLENBRUFBLGNBQUFBLENBQWVzQixHQUNiLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU50QixRQUFRdUIsT0FBTyxVQUFVSCxFQUFJSSxTQUN0QyxHRGpDa0IsQ0FDbEJsQyxRQUFTLGtEQUNUQyxRQUFTLENBQ1BrQyxjQUFlLHVDQUNmLGVBQWdCLHNCQUtwQnRDLEVBQ0dZLGFBQ0FGLE1BQUtSLElBQXVCLElBQXJCcUMsRUFBVUMsR0FBTXRDLEVBQ3RCdUMsRUFBWWxGLFlBQWNnRixFQUFTckIsS0FDbkN3QixFQUFtQm5GLFlBQWNnRixFQUFTYixNQUMxQ2lCLEVBQVlDLElBQU1MLEVBQVNWLE9BRTNCVyxFQUFNbkQsU0FBU3dELElBQ2IsTUFBTUMsRUFBU0MsRUFBZUYsR0FDOUJHLEVBQVVDLE9BQU9ILEVBQU8sR0FDeEIsSUFNSEksTUFBTTdGLFFBQVE4RixPQUVqQixNQUFNQyxFQUFvQmpFLFNBQVNoQixjQUFjLHNCQUMzQ2tGLEVBQWtCbEUsU0FBU2hCLGNBQWMsMEJBQ3pDbUYsRUFBb0JuRSxTQUFTaEIsY0FBYyx3QkFDM0NzRSxFQUFjdEQsU0FBU2hCLGNBQWMsa0JBQ3JDdUUsRUFBcUJ2RCxTQUFTaEIsY0FBYyx5QkFFNUNvRixFQUFZcEUsU0FBU2hCLGNBQWMsZUFDbkNxRixFQUFrQkQsRUFBVXBGLGNBQWMsZ0JBQzFDc0YsRUFBb0JGLEVBQVVwRixjQUFjLHFCQUM1Q3VGLEVBQXFCSCxFQUFVcEYsY0FBYyx1QkFDN0N3RixFQUE0QkosRUFBVXBGLGNBQzFDLDhCQUVJeUYsRUFBWXpFLFNBQVNoQixjQUFjLG1CQUNuQzBGLEVBQVdELEVBQVV6RixjQUFjLGdCQUNuQzJGLEVBQWdCRixFQUFVekYsY0FBYyxzQkFDeEM0RixFQUFvQkgsRUFBVXpGLGNBQWMscUJBQzVDNkYsRUFBZ0JKLEVBQVV6RixjQUFjLHdCQUN4QzhGLEVBQWdCTCxFQUFVekYsY0FBYyx3QkFFOUMsSUFBSStGLEVBQWNDLEVBRWxCLE1BQU1DLEVBQWVqRixTQUFTaEIsY0FBYyxrQkFDdEM2RSxFQUFZN0QsU0FBU2hCLGNBQWMsZ0JBRW5Da0csR0FEWWxGLFNBQVNoQixjQUFjLGdCQUNwQmdCLFNBQVNoQixjQUFjLG1CQUN0Q21HLEVBQXNCRCxFQUFhbEcsY0FBYyxpQkFDakRvRyxFQUF3QkYsRUFBYWxHLGNBQWMsbUJBQ25EcUcsRUFBdUJILEVBQWFsRyxjQUN4QyxrQ0FJSXNHLEVBQWN0RixTQUFTaEIsY0FBYyxpQkFDckN3RSxFQUFjeEQsU0FBU2hCLGNBQWMsb0JBQ3JDdUcsRUFBYUQsRUFBWXRHLGNBQWMsZ0JBRXZDd0csR0FEa0JGLEVBQVl0RyxjQUFjLHNCQUN0QnNHLEVBQVl0RyxjQUFjLHNCQUNoRHlHLEVBQWNILEVBQVl0RyxjQUFjLHlCQUV4QzBHLEVBQWMxRixTQUFTaEIsY0FBYyxpQkFDckMyRyxFQUFhRCxFQUFZMUcsY0FBYyxnQkFDdkM0RyxFQUF1QkYsRUFBWTFHLGNBQWMsc0JBQ2pENkcsRUFBc0JILEVBQVkxRyxjQUFjLHFCQWdCdEQsU0FBUzRFLEVBQWVrQyxHQUN0QixNQUFNQyxFQUFjZCxFQUFhZSxRQUM5QmhILGNBQWMsU0FDZGlILFdBQVUsR0FFUEMsRUFBYUgsRUFBWS9HLGNBQWMsZ0JBQ3ZDbUgsRUFBY0osRUFBWS9HLGNBQWMsZ0JBQ3hDb0gsRUFBY0wsRUFBWS9HLGNBQWMsbUJBQ3hDcUgsRUFBZ0JOLEVBQVkvRyxjQUFjLHFCQXlCaEQsT0FyQkFrSCxFQUFXOUgsWUFBYzBILEVBQUsvRCxLQUM5Qm9FLEVBQVkxQyxJQUFNcUMsRUFBSzlELEtBQ3ZCbUUsRUFBWUcsSUFBTVIsRUFBSy9ELEtBRW5CK0QsRUFBS2pELFNBQ1B1RCxFQUFZbEgsVUFBVVksSUFBSSx3QkFHNUJzRyxFQUFZNUYsaUJBQWlCLFNBQVUrRixHQWxDekMsU0FBb0JBLEVBQUt0SCxHQUN2QixNQUFNdUgsRUFBYUQsRUFBSUUsT0FDakI1RCxFQUFVMkQsRUFBV3RILFVBQVV3SCxTQUFTLHdCQUU5QzdGLEVBQ0crQixpQkFBaUIzRCxFQUFJNEQsR0FDckJ0QixNQUFLLEtBQ0ppRixFQUFXdEgsVUFBVXlILE9BQU8sdUJBQXVCLElBRXBENUMsT0FBT0MsSUFDTjlGLFFBQVE4RixNQUFNLDZCQUE4QkEsRUFBTSxHQUV4RCxDQXNCaUQ0QyxDQUFXTCxFQUFLVCxFQUFLZSxPQUVwRVYsRUFBWTNGLGlCQUFpQixTQUFTLEtBQ3BDc0csRUFBVTVCLEdBQ1ZDLEVBQW9CMUIsSUFBTXFDLEVBQUs5RCxLQUMvQm1ELEVBQW9CbUIsSUFBTVIsRUFBSy9ELEtBQy9CcUQsRUFBc0JoSCxZQUFjMEgsRUFBSy9ELElBQUksSUFHL0NzRSxFQUFjN0YsaUJBQWlCLFNBQVUrRixLQTJHM0MsU0FBMEJSLEVBQWFnQixHQUNyQ2hDLEVBQWVnQixFQUNmZixFQUFpQitCLEVBRWpCRCxFQUFVcEIsRUFDWixDQS9HSXNCLENBQWlCakIsRUFBYUQsRUFBS2UsSUFBSSxJQUdsQ2QsQ0FDVCxDQUVBLFNBQVNlLEVBQVVHLEdBQ2pCQSxFQUFNL0gsVUFBVVksSUFBSSxnQkFDcEJFLFNBQVNRLGlCQUFpQixVQUFXMEcsR0FDckNELEVBQU16RyxpQkFBaUIsWUFBYTJHLEVBQ3RDLENBRUEsU0FBU0MsRUFBV0gsR0FDbEJBLEVBQU0vSCxVQUFVQyxPQUFPLGdCQUN2QmEsU0FBU3FILG9CQUFvQixVQUFXSCxHQUN4Q0QsRUFBTUksb0JBQW9CLFlBQWFGLEVBQ3pDLENBNEdBLFNBQVNELEVBQWFYLEdBQ0osV0FBWkEsRUFBSWUsS0FFTkYsRUFEY3BILFNBQVNoQixjQUFjLGlCQUd6QyxDQUVBLFNBQVNtSSxFQUFjWixHQUNqQkEsRUFBSUUsT0FBT3ZILFVBQVV3SCxTQUFTLFVBQ2hDVSxFQUFXYixFQUFJRSxPQUVuQixDQXRCQXhDLEVBQWtCekQsaUJBQWlCLFNBQVMsS0Q1TmIrRyxJQUFDMUksRUFBbUJFLEVDNk5qRHlGLEVBQTBCZ0QsTUFBUWpFLEVBQW1CbkYsWUFDckRtRyxFQUFtQmlELE1BQVFsRSxFQUFZbEYsWUQ5TlRTLEVDZ081QndGLEVEaE8rQ3RGLEVDa08vQ1YsRUFEQSxDQUFDa0csRUFBb0JDLEdEaE9idEUsU0FBU1YsSUFDakJaLEVBQWVDLEVBQVFXLEVBQU9ULEVBQU8sSUNrT3ZDK0gsRUFBVTFDLEVBQVUsSUFnQnRCRSxFQUFrQjlELGlCQUFpQixTQUFTLEtBQzFDNEcsRUFBV2hELEdBQ1hsRyxRQUFRQyxJQUFJLHVCQUF1QixJQUdyQytGLEVBQWdCMUQsaUJBQWlCLFNBQVMsS0FDeENzRyxFQUFVckMsRUFBVSxJQUd0QkcsRUFBa0JwRSxpQkFBaUIsU0FBUyxLQUMxQzRHLEVBQVczQyxFQUFVLElBR3ZCWSxFQUFxQjdFLGlCQUFpQixTQUFTLEtBQzdDNEcsRUFBV2xDLEVBQWEsSUFHMUJmLEVBQWtCM0QsaUJBQWlCLFNBQVMsS0FDMUNzRyxFQUFVeEIsRUFBWSxJQUd4QkUsRUFBb0JoRixpQkFBaUIsU0FBUyxLQUM1QzRHLEVBQVc5QixFQUFZLElBR3pCTyxFQUFvQnJGLGlCQUFpQixTQUFTLEtBQzVDNEcsRUFBVzFCLEVBQVksSUFHekJFLEVBQXFCcEYsaUJBQWlCLFNBQVMsS0FDN0M0RyxFQUFXMUIsRUFBWSxJQUV6QkgsRUFBVy9FLGlCQUFpQixVQXZHNUIsU0FBNEIrRixHQUMxQkEsRUFBSWtCLGlCQUNKLE1BQU1DLEVBQVlqQyxFQUFZK0IsTUFDeEJHLEVBQVlwQixFQUFJcUIsVUFDdEJsSyxFQUFjaUssR0FBVyxFQUFNLE9BQVEsYUFFdkM5RyxFQUNHMkIsZUFBZSxDQUFFRSxPQUFRZ0YsSUFDekJuRyxNQUFNdUUsSUFDTHRDLEVBQVlDLElBQU1xQyxFQUFLcEQsT0FDdkIwRSxFQUFXOUIsRUFBWSxJQUV4QnZCLE1BQU03RixRQUFROEYsT0FDZDZELFNBQVEsS0FDUG5LLEVBQWNpSyxHQUFXLEVBQU0sR0FFckMsSUF5RkFoQyxFQUFXbkYsaUJBQWlCLFVBdkY1QixTQUE0QitGLEdBQzFCQSxFQUFJa0IsaUJBRUosTUFBTUUsRUFBWXBCLEVBQUlxQixVQUN0QmxLLEVBQWNpSyxHQUFXLEVBQU0sU0FBVSxlQUV6QzlHLEVBQ0c4QixXQUFXcUMsR0FDWHpELE1BQUssS0FDQXdELElBQ0ZBLEVBQWE1RixTQUNiNEYsRUFBZSxLQUNmQyxFQUFpQixNQUVuQm9DLEVBQVcxQixFQUFZLElBRXhCM0IsTUFBTTdGLFFBQVE4RixPQUNkNkQsU0FBUSxLQUNQbkssRUFBY2lLLEdBQVcsRUFBTyxTQUFVLGNBQWMsR0FFOUQsSUFxRUF0RCxFQUFnQjdELGlCQUFpQixVQTNKakMsU0FBOEIrRixHQUM1QkEsRUFBSWtCLGlCQUVKLE1BQU1FLEVBQVlwQixFQUFJcUIsVUFDdEJsSyxFQUFjaUssR0FBVyxFQUFNLE9BQVEsYUFFdkM5RyxFQUNHd0IsYUFBYSxDQUNaTixLQUFNd0MsRUFBbUJpRCxNQUN6QmpGLE1BQU9pQyxFQUEwQmdELFFBRWxDakcsTUFBTXVFLElBQ0x4QyxFQUFZbEYsWUFBYzBILEVBQUsvRCxLQUMvQndCLEVBQW1CbkYsWUFBYzBILEVBQUt2RCxNQUN0QzZFLEVBQVdoRCxFQUFVLElBRXRCTCxNQUFNN0YsUUFBUThGLE9BQ2Q2RCxTQUFRLEtBQ1BuSyxFQUFjaUssR0FBVyxFQUFNLEdBRXJDLElBd0lBakQsRUFBU2xFLGlCQUFpQixVQXRJMUIsU0FBNkIrRixHQUMzQkEsRUFBSWtCLGlCQUNKLE1BQU1LLEVBQWMsQ0FDbEIvRixLQUFNOEMsRUFBYzJDLE1BQU1PLE9BQzFCL0YsS0FBTThDLEVBQWMwQyxNQUFNTyxRQUd0QkosRUFBWXBCLEVBQUlxQixVQUN0QmxLLEVBQWNpSyxHQUFXLEVBQU0sT0FBUSxhQUV2QzlHLEVBQ0dnQixRQUFRaUcsR0FDUnZHLE1BQU15RyxJQUNMLE1BQU1yRSxFQUFTQyxFQUFlb0UsR0FDOUJuRSxFQUFVb0UsUUFBUXRFLEdBQ2xCeUQsRUFBVzNDLEdBQ1g4QixFQUFJRSxPQUFPeUIsUUFDWHRJLEVBQWMrRSxFQUFldEcsRUFBUyxJQUV2QzBGLE1BQU03RixRQUFROEYsT0FDZDZELFNBQVEsS0FDUG5LLEVBQWNpSyxHQUFXLEVBQU0sR0FFckMsSUFpSEE1SCxFQUFpQjFCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gc2V0QnV0dG9uVGV4dChcbiAgYnRuLFxuICBpc0xvYWRpbmcsXG4gIGRlZmF1bHRUZXh0ID0gXCJTYXZlXCIsXG4gIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIlxuKSB7XG4gIGlmIChpc0xvYWRpbmcpIHtcbiAgICAvL3NldCB0aGUgbG9hZGluZyB0ZXh0XG4gICAgY29uc29sZS5sb2coYFNldHRpbmcgdGV4dCB0byAke2xvYWRpbmdUZXh0fWApO1xuICAgIGJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICB9IGVsc2Uge1xuICAgIC8vIHNldCB0aGUgbm90IGxvYWRpbmcgdGV4dFxuICAgIGJ0bi50ZXh0Q29udGVudCA9IGRlZmF1bHRUZXh0O1xuICB9XG59XG4iLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JNc2dFTCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICBlcnJvck1zZ0VMLnRleHRDb250ZW50ID0gZXJyb3JNc2c7XG4gIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnRUwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgZXJyb3JNc2dFTC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xuICBjb25zb2xlLmxvZyhpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbCwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBidXR0b25FbC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbCwgY29uZmlnKSA9PiB7XG4gIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG59O1xuXG5leHBvcnQgY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbCwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dCwgY29uZmlnKTtcbiAgfSk7XG59O1xuXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWwsIGNvbmZpZykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBjb25maWcpO1xuICB9KTtcbn07XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuIiwiaW1wb3J0IHsgc2V0QnV0dG9uVGV4dCB9IGZyb20gXCIuLi91dGlscy9oZWxwZXJzLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICBlbmFibGVWYWxpZGF0aW9uLFxuICBzZXR0aW5ncyxcbiAgcmVzZXRWYWxpZGF0aW9uLFxuICBkaXNhYmxlQnV0dG9uLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5cbi8vY29uc3QgaW5pdGlhbENhcmRzID0gW1xuLy97XG4vL25hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbi8vbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzYtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxuLy99LFxuLy8ge1xuLy9uYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcbi8vIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuLy8gfSxcbi8ve1xuLy8gbmFtZTogXCJBIHZlcnkgbG9uZyBicmlkZ2UsIG92ZXIgdGhlIGZvcmVzdCBhbmQgdGhyb3VnaCB0aGUgdHJlZXNcIixcbi8vIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcbi8vfSxcbi8ve1xuLy9uYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuLy9saW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuLy99LFxuLy97XG4vLyBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuLy9saW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiLFxuLy8gfSxcbi8ve1xuLy9uYW1lOiBcIlZhbCBUaG9yZW5zXCIsXG4vL2xpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8xLXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbi8vfSxcbi8vIHtcbi8vbmFtZTogXCJHb2xkZW4gR2F0ZSBicmlkZ2VcIixcbi8vbGluazogXCIgaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy83LXBob3RvLWJ5LWdyaWZmaW4td29vbGRyaWRnZS1mcm9tLXBleGVscy5qcGdcIixcbi8vfSxcbi8vXTtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiOTU0NGMzYTItOWNhMS00OGY1LWEyZTEtOGRhOTlhNzkyNGU0XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuLy9kZXN0cnVjdHVyZSBzZWNvbmQgaXRlbSBpbiB0aGVjYWxsYmFjayBvZiB0aGUgLnRoZW4oIClcbmFwaVxuICAuZ2V0QXBwSW5mbygpXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcbiAgICBhdmF0YXJJbWFnZS5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XG5cbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWwgPSBnZXRDYXJkRWxlbWVudChpdGVtKTtcbiAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsKTtcbiAgICB9KTtcblxuICAgIC8vaGFuZGxlIHRoZSB1c2VyJ3MgaW5mb3JtYXRpb25cbiAgICAvL3NldCB0aGUgc3JjIG9mIHRoZSBhdmF0YXIgaW1hZ2VcbiAgICAvLyBzZXQgdGhlIHRleHRDb250ZW50IG9mIGJvdGggdGhlIHRleHQgZWxlbWVudHNcbiAgfSlcbiAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XG5jb25zdCBjYXJkTW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25ldy1wb3N0LWJ0blwiKTtcbmNvbnN0IGF2YXRhck1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnRuXCIpO1xuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbW9kYWxcIik7XG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGVkaXRNb2RhbENsb3NlQnRuID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IGVkaXRNb2RhbE5hbWVJbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuY29uc3QgY2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGNhcmRGb3JtID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBjYXJkU3VibWl0QnRuID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XG5jb25zdCBjYXJkTW9kYWxDbG9zZUJ0biA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBjYXJkTmFtZUlucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbmFtZS1pbnB1dFwiKTtcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1saW5rLWlucHV0XCIpO1xuXG5sZXQgc2VsZWN0ZWRDYXJkLCBzZWxlY3RlZENhcmRJZDtcblxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmNvbnN0IGNhcmRJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxJbWFnZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbkVMID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fY2xvc2UtYnRuX3R5cGVfcHJldmlld1wiXG4pO1xuXG4vL0F2YXRhciBmb3JtIGVsZW1lbnRzXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xuY29uc3QgYXZhdGFySW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcbmNvbnN0IGF2YXRhckZvcm0gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgYXZhdGFyU3VibWl0QnRuID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcbmNvbnN0IGF2YXRhck1vZGFsQ2xvc2VCdG4gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBhdmF0YXJJbnB1dCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItaW5wdXRcIik7XG5cbmNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtbW9kYWxcIik7XG5jb25zdCBkZWxldGVGb3JtID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGRlbGV0ZU1vZGFsQ2FuY2VsQnRuID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FuY2VsLWJ0blwiKTtcbmNvbnN0IGRlbGV0ZU1vZGFsQ2xvc2VCdG4gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2UoZXZ0LCBpZCkge1xuICBjb25zdCBsaWtlQnV0dG9uID0gZXZ0LnRhcmdldDtcbiAgY29uc3QgaXNMaWtlZCA9IGxpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG5cbiAgYXBpXG4gICAgLmNoYW5nZUxpa2VTdGF0dXMoaWQsIGlzTGlrZWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgbGlrZSBzdGF0dXNcIiwgZXJyb3IpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICBjb25zdCBjYXJkTmFtZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG4gIGNvbnN0IGNhcmREZWxldGVCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idG5cIik7XG5cbiAgLy8gVG9kby0gaWYgdGhlIGNhcmQgaXMgbGlrZWQgc2V0IHRoZSBhY3RpdmUgY2xhc3Mgb24gdGhlIGNhcmRcblxuICBjYXJkTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcblxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XG4gICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xuICB9XG5cbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IGhhbmRsZUxpa2UoZXZ0LCBkYXRhLl9pZCkpO1xuXG4gIGNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XG4gICAgcHJldmlld01vZGFsSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XG4gICAgcHJldmlld01vZGFsSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XG4gICAgcHJldmlld01vZGFsQ2FwdGlvbkVMLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICB9KTtcblxuICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YS5faWQpO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZU92ZXJsYXkpO1xufVxuXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XG4gIG1vZGFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgaGFuZGxlT3ZlcmxheSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xuXG4gIGFwaVxuICAgIC5lZGl0VXNlckluZm8oe1xuICAgICAgbmFtZTogZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlLFxuICAgICAgYWJvdXQ6IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUsXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xuICAgICAgY2xvc2VNb2RhbChlZGl0TW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGlucHV0VmFsdWVzID0ge1xuICAgIG5hbWU6IGNhcmROYW1lSW5wdXQudmFsdWUudHJpbSgpLFxuICAgIGxpbms6IGNhcmRMaW5rSW5wdXQudmFsdWUudHJpbSgpLFxuICB9O1xuXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XG5cbiAgYXBpXG4gICAgLmFkZENhcmQoaW5wdXRWYWx1ZXMpXG4gICAgLnRoZW4oKG5ld0NhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWwgPSBnZXRDYXJkRWxlbWVudChuZXdDYXJkRGF0YSk7XG4gICAgICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWwpO1xuICAgICAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xuICAgICAgZGlzYWJsZUJ1dHRvbihjYXJkU3VibWl0QnRuLCBzZXR0aW5ncyk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UpO1xuICAgIH0pO1xufVxuXG4vLyBUb2RvIC0gRmluaXNoIGF2YXRhciBzdWJtaXNzaW9uIEhhbmRsZXJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGF2YXRhclVybCA9IGF2YXRhcklucHV0LnZhbHVlO1xuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xuXG4gIGFwaVxuICAgIC5lZGl0QXZhdGFySW5mbyh7IGF2YXRhcjogYXZhdGFyVXJsIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIGF2YXRhckltYWdlLnNyYyA9IGRhdGEuYXZhdGFyO1xuICAgICAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlLCBcIkRlbGV0ZVwiLCBcIkRlbGV0aW5nLi4uXCIpO1xuXG4gIGFwaVxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGlmIChzZWxlY3RlZENhcmQpIHtcbiAgICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgICBzZWxlY3RlZENhcmQgPSBudWxsO1xuICAgICAgICBzZWxlY3RlZENhcmRJZCA9IG51bGw7XG4gICAgICB9XG4gICAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCBmYWxzZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKSB7XG4gIHNlbGVjdGVkQ2FyZCA9IGNhcmRFbGVtZW50O1xuICBzZWxlY3RlZENhcmRJZCA9IGNhcmRJZDtcblxuICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xufVxuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgcmVzZXRWYWxpZGF0aW9uKFxuICAgIGVkaXRGb3JtRWxlbWVudCxcbiAgICBbZWRpdE1vZGFsTmFtZUlucHV0LCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0XSxcbiAgICBzZXR0aW5nc1xuICApO1xuICBvcGVuTW9kYWwoZWRpdE1vZGFsKTtcbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XG4gIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcbiAgICBjbG9zZU1vZGFsKG1vZGFsKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVPdmVybGF5KGV2dCkge1xuICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSkge1xuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XG4gIH1cbn1cblxuZWRpdE1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChlZGl0TW9kYWwpO1xuICBjb25zb2xlLmxvZyhcImNsb3NlIGJ1dHRvbiBjbGlja2VkXCIpO1xufSk7XG5cbmNhcmRNb2RhbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwoY2FyZE1vZGFsKTtcbn0pO1xuXG5jYXJkTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XG59KTtcblxucHJldmlld01vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xufSk7XG5cbmF2YXRhck1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChhdmF0YXJNb2RhbCk7XG59KTtcblxuYXZhdGFyTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcbn0pO1xuXG5kZWxldGVNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xufSk7XG5cbmRlbGV0ZU1vZGFsQ2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xufSk7XG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQXZhdGFyU3VibWl0KTtcblxuZGVsZXRlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XG5cbmVkaXRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRGb3JtU3VibWl0KTtcbmNhcmRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuLy9wYXNzIHNldHRpbmdzIG9iamVjdCB0byB2YWxpZGF0aW9uIGZ1bmN0aW9ucyB0aGF0IGFyZSBjYWxsZWRcbi8vaW4gdGhpcyBmaWxlXG4iLCJjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICAgIC8vIGNvbnN0cnVjdG9yIGJvZHlcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldEFwcEluZm8oKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdEF2YXRhckluZm8oeyBhdmF0YXIgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgY2hhbmdlTGlrZVN0YXR1cyhpZCwgaXNMaWtlZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBcGk7XG4iXSwibmFtZXMiOlsic2V0QnV0dG9uVGV4dCIsImJ0biIsImlzTG9hZGluZyIsImRlZmF1bHRUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwibG9hZGluZ1RleHQiLCJjb25zb2xlIiwibG9nIiwidGV4dENvbnRlbnQiLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWwiLCJpbnB1dEVsIiwiY29uZmlnIiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbCIsInNvbWUiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJhZGQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInNldEV2ZW50TGlzdGVuZXJzIiwiQXJyYXkiLCJmcm9tIiwiYnV0dG9uRWxlbWVudCIsImlucHV0RWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNc2ciLCJhcGkiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJfY2hlY2tSZXNwb25zZSIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzIiwiYWRkQ2FyZCIsIl9yZWYyIiwibmFtZSIsImxpbmsiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRVc2VySW5mbyIsIl9yZWYzIiwiYWJvdXQiLCJlZGl0QXZhdGFySW5mbyIsIl9yZWY0IiwiYXZhdGFyIiwiZGVsZXRlQ2FyZCIsImNoYW5nZUxpa2VTdGF0dXMiLCJpc0xpa2VkIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiYXV0aG9yaXphdGlvbiIsInVzZXJEYXRhIiwiY2FyZHMiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsImF2YXRhckltYWdlIiwic3JjIiwiaXRlbSIsImNhcmRFbCIsImdldENhcmRFbGVtZW50IiwiY2FyZHNMaXN0IiwiYXBwZW5kIiwiY2F0Y2giLCJlcnJvciIsInByb2ZpbGVFZGl0QnV0dG9uIiwiY2FyZE1vZGFsQnV0dG9uIiwiYXZhdGFyTW9kYWxCdXR0b24iLCJlZGl0TW9kYWwiLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0TW9kYWxDbG9zZUJ0biIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJjYXJkTW9kYWwiLCJjYXJkRm9ybSIsImNhcmRTdWJtaXRCdG4iLCJjYXJkTW9kYWxDbG9zZUJ0biIsImNhcmROYW1lSW5wdXQiLCJjYXJkTGlua0lucHV0Iiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJjYXJkVGVtcGxhdGUiLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3TW9kYWxJbWFnZUVsIiwicHJldmlld01vZGFsQ2FwdGlvbkVMIiwicHJldmlld01vZGFsQ2xvc2VCdG4iLCJhdmF0YXJNb2RhbCIsImF2YXRhckZvcm0iLCJhdmF0YXJNb2RhbENsb3NlQnRuIiwiYXZhdGFySW5wdXQiLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJkZWxldGVNb2RhbENhbmNlbEJ0biIsImRlbGV0ZU1vZGFsQ2xvc2VCdG4iLCJkYXRhIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbCIsImNhcmRJbWFnZUVsIiwiY2FyZExpa2VCdG4iLCJjYXJkRGVsZXRlQnRuIiwiYWx0IiwiZXZ0IiwibGlrZUJ1dHRvbiIsInRhcmdldCIsImNvbnRhaW5zIiwidG9nZ2xlIiwiaGFuZGxlTGlrZSIsIl9pZCIsIm9wZW5Nb2RhbCIsImNhcmRJZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJtb2RhbCIsImhhbmRsZUVzY2FwZSIsImhhbmRsZU92ZXJsYXkiLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInJlc2V0VmFsaWRhdGlvbiIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJhdmF0YXJVcmwiLCJzdWJtaXRCdG4iLCJzdWJtaXR0ZXIiLCJmaW5hbGx5IiwiaW5wdXRWYWx1ZXMiLCJ0cmltIiwibmV3Q2FyZERhdGEiLCJwcmVwZW5kIiwicmVzZXQiXSwic291cmNlUm9vdCI6IiJ9